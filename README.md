# Проект по предсказанию калорийности блюд

## Описание

В проекте реализована мультимодальная нейросеть для предсказания калорийности блюд на основе фотографий и списка ингредиентов. Результат работы сети - количество калорий на 100 грамм блюда.

## Архитектура

### Мультимодальная модель
Проект реализует архитектуру, объединяющую два предобученных энкодера:

1. **Текстовый энкодер**: BERT (`bert-base-uncased`)

2. **Визуальный энкодер**: EfficientNet-B0 (`tf_efficientnet_b0`)

3. **Регрессор**: Полносвязная нейронная сеть
   - Объединяет текстовые и визуальные признаки методом конкатенации векторов
   - Предсказывает калорийность в cal/100g

## Структура проекта

```
project-calories/
├── data/                          # Данные проекта
│   ├── dish.csv                   # Данные блюд (калории, ингредиенты)
│   ├── ingredients.csv            # Справочник ингредиентов
│   └── images/                    # Изображения блюд
├── scripts/                       # Модули проекта
│   ├── dataset.py                 # Загрузка и предобработка данных
│   ├── utils.py                   # Модель, обучение, оценка
│   └── visualize.py               # Визуализация результатов
├── notebook.ipynb                 # Анализ, обучение и оценка модели
├── requirements.txt               # Зависимости проекта
└── best_model.pth                 # Лучшая обученная модель
```

## Данные

### Датасет
- **Блюда**: 3262 блюда с изображениями, калорийностью, массой и списком ингредиентов
- **Ингредиенты**: 555 уникальных ингредиентов

### Предобработка
- **Изображения**: Ресайз до 224×224, нормализация, аугментация
- **Текст**: Преобразование ID ингредиентов в названия, токенизация
- **Целевая переменная**: Калории на 100г = (общая_калорийность / общая_масса) × 100

## Технические детали

### Гиперпараметры
- **Batch size**: 256
- **Learning rates**: 
  - BERT: 3e-5
  - EfficientNet: 1e-4  
  - Регрессор: 3e-3
- **Epochs**: 35
- **Dropout**: 0.3
- **Hidden dimension**: 256

### Аугментация данных
- Геометрические трансформации (поворот, масштаб, сдвиг)
- Цветовые искажения (яркость, контраст, насыщенность)
- Аугментация прямоугольными шумами

### Функция потерь
SmoothL1Loss с β=20

## Результаты

### Метрики качества
- **MAE (Mean Absolute Error)**: ~48.03 cal/100g на тестовой выборке
- **Среднее предсказание**: 105.24 cal/100g
- **Среднее истинное значение**: 143.62 cal/100g

